<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Freefoil</title>
    <script src="freefoil.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"
    />
  </head>
  <body>
    <div class="title-container">
      <h1>Freefoil</h1>
      <div class="svg">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          version="1.0"
          viewBox="0 0 550.000000 550.000000"
          preserveAspectRatio="xMidYMid meet"
        >
          <g
            transform="translate(0.000000,550.000000) scale(0.100000,-0.100000)"
            fill="#000000"
            stroke="none"
          >
            <path
              d="M1365 5154 c-481 -86 -868 -442 -990 -910 -44 -169 -47 -268 -42 -1579 3 -1204 4 -1232 24 -1325 111 -501 467 -858 973 -976 66 -15 150 -18 691 -21 560 -4 618 -3 633 12 15 15 16 208 16 2396 0 1622 -3 2386 -10 2400 -10 18 -27 19 -613 18 -476 -1 -619 -4 -682 -15z m905 -2400 l0 -2026 -407 5 c-375 4 -415 6 -490 25 -322 83 -561 331 -628 654 -22 101 -22 2589 -1 2688 60 281 255 514 518 619 132 53 193 59 621 60 l387 1 0 -2026z"
            />
            <path
              d="M1451 4169 c-63 -12 -159 -60 -210 -105 -105 -91 -157 -220 -149 -372 4 -79 9 -100 41 -164 47 -97 118 -168 215 -216 67 -33 84 -37 171 -40 79 -3 107 0 160 18 217 73 348 284 311 500 -43 257 -287 429 -539 379z"
            />
            <path
              d="M3157 5163 c-4 -3 -7 -1087 -7 -2409 0 -2181 1 -2402 16 -2408 27 -10 803 -6 899 4 406 46 764 293 959 660 25 47 58 126 75 175 63 188 61 138 61 1575 0 1147 -2 1318 -16 1391 -99 521 -496 914 -1018 1004 -70 12 -178 15 -526 15 -240 0 -440 -3 -443 -7z m1068 -2178 c156 -41 284 -160 336 -312 33 -94 32 -232 -1 -318 -61 -158 -181 -269 -335 -310 -250 -65 -516 86 -589 334 -22 76 -21 204 4 282 75 245 335 389 585 324z"
            />
          </g>
        </svg>
      </div>
    </div>
    <h3>Generates a Google oauth token file for Tinfoil on the Switch</h3>

    <h3>Step 1</h3>
    <div class="content">
      <p>Load your credentials.json file:</p>
      <input type="file" id="file-selector" accept=".json" />

      <div>
        <label for="clientID">Client ID</label>
        <input type="text" id="clientID" placeholder="Client ID" readonly />
        <label for="clientID">Client Secret</label>
        <input
          type="text"
          id="clientSecret"
          placeholder="Client Secret"
          readonly
        />
        <label for="appType"
          >App type
          <span
            class="app-info"
            data-text="App type defined when creating oauth credentials. It should be Desktop or Web, though Web is preferred. To make a web app, when creating OAuth client ID, choose Web Application instead of desktop app. Add https://sphynxinatorx.github.io/freefoil/ and http://localhost as authorized redirect URIs.  Create, download the JSON file and use here."
            >â“˜</span
          ></label
        >
        <input type="text" id="appType" placeholder="App type" readonly />
      </div>
    </div>

    <h3>Step 2</h3>
    <div class="content">
      <p>
        Make sure you are logged into the Google account that you want to auth
        with. <br />
        Click the button below. This will open a Google Oauth popup window.
        <br />
        Follow the steps and authorize the app. <br />
      </p>
      <button id="openAuth" disabled>Authorize</button>
      <div id="copyStep">
        <p>
          Once it has completed (the popup page should fail saying it can't be
          reached or connection refused), copy the entire popup URL into the
          field below. This should be automatic if using the web app type.
        </p>
        <input
          id="authURL"
          placeholder="http://localhost:8080/?state=pass..."
        />
        <p class="authURLValid"></p>
      </div>
    </div>

    <div id="generateStep">
      <h3>Step 3</h3>
      <div class="content">
        <p>
          This will download a gdrive.token file. This file, along with
          credentials.json should go to your SDCARD\switch\tinfoil folder.<br />
          Mobile browsers might append .txt to the token file download, this
          will need to be removed.
        </p>
        <button id="generateToken" disabled>Generate Token</button>
      </div>
    </div>

    <br /><br />
    <p>By Sphynxintor</p>
    <a href="https://github.com/SphynxinatorX/freefoil">Source code</a>
  </body>
</html>

<style>
  input {
    min-width: 90%;
  }
  .svg {
    width: 50px;
    padding-left: 1rem;
    margin-top: 1rem;
  }
  .title-container {
    display: flex;
    align-items: center;
  }
  .authURLValid {
    margin: 0;
  }
  .content {
    padding-left: 1rem;
  }
  .app-info {
    position: relative;
    border-bottom: 1px dashed #000;
  }
  .app-info:before {
    content: attr(data-text);
    position: absolute;
    top: 50%;
    transform: translate(-30%, 5%);
    left: 100%;
    margin-left: 15px;
    width: 350px;
    padding: 10px;
    border-radius: 10px;
    background: #000;
    color: #fff;
    text-align: center;
    display: none;
  }
  .app-info:hover:before {
    display: block;
  }
</style>
